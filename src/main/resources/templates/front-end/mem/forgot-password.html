<!DOCTYPE html>
<html lang="zh-Hant" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Robin - Furniture eCommerce</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Favicon -->
<link th:href="@{/img/favicon.ico}" rel="icon">

<!-- Vendor CSS -->
<link th:href="@{/css/vendors.css}" rel="stylesheet">
<!-- Main CSS -->
<link th:href="@{/css/style.css}" rel="stylesheet">
<!-- Bootstrap CSS -->
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
	rel="stylesheet">
<!-- Font Awesome -->
<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
<style>
body {
  background-color: #ffffff;
}

.card {
  border: 1px solid #dee2e6;
  box-shadow: 0 2px 6px rgba(0,0,0,0.05);
}

.btn {
  border-radius: 0.375rem;
}

.form-control {
  border-radius: 0.375rem; 
}
</style>
</head>

<body>
	<!--====================  header area ====================-->
	<div
		class="header-area header-area--default header-area--default--white header-sticky">
		<div class="header-logo">
			<a th:href="@{/}"> <img th:src="@{/img/logo.png}"
				class="img-fluid" alt="Logo">
			</a>
		</div>

		<!-- header navigation -->
		<div class="header-navigation-area d-none d-lg-block">
			<div class="container wide">
				<div class="row">
					<div class="col-lg-12">
						<div class="header-info-wrapper">
							<div class="header-navigation-wrapper">
								<nav>
									<ul>
										<li><a th:href="@{/products}">商品瀏覽</a></li>
										<li><a th:href="@{/compare}">商品比較</a></li>
										<li><a th:href="@{/custom}">客製化商品</a></li>
										<li><a th:href="@{/knowledge}">好眠知識</a></li>
									</ul>
								</nav>
							</div>

							<!-- search bar -->
							<nav class="navbar navbar-expand-lg navbar-light bg-light">
								<div class="container-fluid">
									<div class="collapse navbar-collapse">
										<form class="d-flex" th:action="@{/search}" method="get">
											<input class="form-control me-2" type="search" name="q"
												placeholder="搜尋商品">
											<button class="btn btn-outline-success" type="submit">Search</button>
										</form>
									</div>
								</div>
							</nav>

							<!-- header icons -->
							<div class="header-icon-area">
								<ul class="header-icon__list">
									<!-- 訊息 -->
									<li><a th:href="@{/messages}"> <i
											class="fa-solid fa-message" style="color: #B197FC;"></i>
									</a></li>
									<!-- 會員 -->

									<li class="nav-item"><a th:href="@{/mem/login}"
										th:if="${session.memberId == null}" data-bs-toggle="tooltip"
										data-bs-placement="bottom" title="登入/註冊"> <i
											class="fa-solid fa-user" style="color: #B197FC;"></i>
									</a> <!-- 已登入 → 顯示會員選單 --> <span
										th:if="${session.memberId != null}"> <i
											class="fa-solid fa-user" style="color: #B197FC;"></i> <a
											th:href="@{/mem/my-account}" class="ms-2">我的帳戶</a> | <a
											th:href="@{/mem/coupons}" class="ms-2">我的優惠券</a> | <a
											th:href="@{/mem/orders}" class="ms-2">我的訂單</a> | <a
											th:href="@{/emp/logout}" class="ms-2">登出</a>
									</span></li>
									<!-- 通知 -->
									<li><a th:href="@{/notifications}"> <i
											class="fa-solid fa-bell" style="color: #B197FC;"></i>
									</a></li>
									<!-- 購物車 -->
									<li><a th:href="@{/cart}"> <i
											class="fa-solid fa-cart-shopping" style="color: #B197FC;"></i>
									</a>
										<div class="minicart-wrapper">
											<p class="minicart-wrapper__title">購物車</p>
											<div class="minicart-wrapper__items ps-scroll">
												<div class="minicart-wrapper__items__single">
													<a href="javascript:void(0)" class="close-icon"> <i
														class="pe-7s-close"></i>
													</a>
													<div class="image">
														<a th:href="@{/products}"> <img
															th:src="@{/img/products/product-2-90x100.jpg}"
															class="img-fluid" alt="">
														</a>
													</div>
													<div class="content">
														<p class="product-title">
															<a th:href="@{/products}">Jane Lauren Rebel Sofa</a>
														</p>
														<p class="product-calculation">
															<span class="count">1</span> x <span class="price">$900</span>
														</p>
													</div>
												</div>
											</div>
											<p class="minicart-wrapper__subtotal">
												總計: <span>$1800</span>
											</p>
											<div class="minicart-wrapper__buttons">
												<a th:href="@{/cart}"
													class="theme-button theme-button--minicart-button">查看購物車</a>
											</div>
										</div></li>
								</ul>
							</div>
							<!-- end of header icons -->

						</div>
						<!-- header-info-wrapper -->
					</div>
				</div>
			</div>
		</div>
	</div>
	<!--====================  End of header area  ====================-->

	<div class="container py-5">
		<div class="row justify-content-center">
			<div class="col-lg-5 col-md-6 col-sm-10">
				<div class="card p-4 shadow-sm rounded-3">
					<h1 class="h4 mb-4 text-center">忘記密碼</h1>

					<!-- 錯誤/成功訊息 -->
					<div th:if="${errorMsg}" class="alert alert-danger"
						th:text="${errorMsg}"></div>
					<div th:if="${successMsg}" class="alert alert-success"
						th:text="${successMsg}"></div>

					<!-- Step 1: 信箱 + 驗證碼 -->
					<div th:if="${step == 1}">
						<form th:action="@{/mem/forgot-password/send}" method="post"
							class="mb-3">
							<label for="email" class="form-label">註冊信箱</label> <input
								id="email" name="email" type="email" class="form-control"
								th:value="${email}" required>
							<button type="submit" class="btn btn-primary w-100 mt-3">寄送驗證碼</button>
						</form>

						<form th:action="@{/mem/forgot-password/verify}" method="post">
							<input type="hidden" name="email" th:value="${email}"> <label
								for="code" class="form-label">驗證碼</label> <input id="code"
								name="code" type="text" class="form-control" required>
							<button type="submit" class="btn btn-success w-100 mt-3">確認驗證碼</button>
						</form>
					</div>

					<!-- Step 2: 新密碼 -->
					<div th:if="${step == 2}">
						<form th:action="@{/mem/forgot-password/reset}" method="post">
							<input type="hidden" name="email" th:value="${email}"> <label
								for="newPassword" class="form-label">新密碼</label> <input
								id="newPassword" name="newPassword" type="password"
								class="form-control" required> <label
								for="confirmPassword" class="form-label mt-2">確認新密碼</label> <input
								id="confirmPassword" name="confirmPassword" type="password"
								class="form-control" required>

							<button type="submit" class="btn btn-success w-100 mt-3">設定新密碼</button>
						</form>
					</div>
				</div>
			</div>
		</div>
	</div>


	<!-- JS files -->
	<script th:src="@{/js/vendors.js}"></script>
	<script th:src="@{/js/active.js}"></script>
	<script th:if="${resetSuccess}" type="text/javascript">
		alert("密碼更新完成，點擊確認跳轉回登入畫面。");
		window.location.href = /*[[@{/mem/login}]]*/'/mem/login';
	</script>



</body>
</html>